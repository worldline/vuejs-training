<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>State management | Introduction to Vue.js</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Discover Vue.js framework through this 2-days training">
    
    <link rel="preload" href="/vuejs-training/assets/css/0.styles.bc0ba21a.css" as="style"><link rel="preload" href="/vuejs-training/assets/js/app.1ac87feb.js" as="script"><link rel="preload" href="/vuejs-training/assets/js/3.9c71ca5a.js" as="script"><link rel="preload" href="/vuejs-training/assets/js/23.3703f9a3.js" as="script"><link rel="prefetch" href="/vuejs-training/assets/js/10.40b6cec4.js"><link rel="prefetch" href="/vuejs-training/assets/js/11.ed8f8aa4.js"><link rel="prefetch" href="/vuejs-training/assets/js/12.587a396a.js"><link rel="prefetch" href="/vuejs-training/assets/js/13.39ef95d5.js"><link rel="prefetch" href="/vuejs-training/assets/js/14.4392fcc5.js"><link rel="prefetch" href="/vuejs-training/assets/js/15.b5bb4985.js"><link rel="prefetch" href="/vuejs-training/assets/js/16.23f8c53b.js"><link rel="prefetch" href="/vuejs-training/assets/js/17.1372593b.js"><link rel="prefetch" href="/vuejs-training/assets/js/18.0206bbdd.js"><link rel="prefetch" href="/vuejs-training/assets/js/19.03f5159e.js"><link rel="prefetch" href="/vuejs-training/assets/js/2.7b4135f7.js"><link rel="prefetch" href="/vuejs-training/assets/js/20.46052103.js"><link rel="prefetch" href="/vuejs-training/assets/js/21.2a1dc9b0.js"><link rel="prefetch" href="/vuejs-training/assets/js/22.509f8821.js"><link rel="prefetch" href="/vuejs-training/assets/js/24.61af4414.js"><link rel="prefetch" href="/vuejs-training/assets/js/25.873be683.js"><link rel="prefetch" href="/vuejs-training/assets/js/26.5beca49b.js"><link rel="prefetch" href="/vuejs-training/assets/js/27.ac1acf86.js"><link rel="prefetch" href="/vuejs-training/assets/js/28.f2e51b80.js"><link rel="prefetch" href="/vuejs-training/assets/js/29.b3b2815b.js"><link rel="prefetch" href="/vuejs-training/assets/js/30.09bea011.js"><link rel="prefetch" href="/vuejs-training/assets/js/31.68cba608.js"><link rel="prefetch" href="/vuejs-training/assets/js/32.7797136c.js"><link rel="prefetch" href="/vuejs-training/assets/js/33.47734303.js"><link rel="prefetch" href="/vuejs-training/assets/js/34.30a311fe.js"><link rel="prefetch" href="/vuejs-training/assets/js/35.0ed18b8d.js"><link rel="prefetch" href="/vuejs-training/assets/js/36.8090ec62.js"><link rel="prefetch" href="/vuejs-training/assets/js/37.2de0af54.js"><link rel="prefetch" href="/vuejs-training/assets/js/38.5dd82804.js"><link rel="prefetch" href="/vuejs-training/assets/js/39.db5e8b56.js"><link rel="prefetch" href="/vuejs-training/assets/js/4.3340eb74.js"><link rel="prefetch" href="/vuejs-training/assets/js/40.79aa6197.js"><link rel="prefetch" href="/vuejs-training/assets/js/41.76a2fbb8.js"><link rel="prefetch" href="/vuejs-training/assets/js/42.76d6f69c.js"><link rel="prefetch" href="/vuejs-training/assets/js/5.acaff3c9.js"><link rel="prefetch" href="/vuejs-training/assets/js/6.69994d5d.js"><link rel="prefetch" href="/vuejs-training/assets/js/7.4d297742.js"><link rel="prefetch" href="/vuejs-training/assets/js/8.9aa2b887.js"><link rel="prefetch" href="/vuejs-training/assets/js/9.69e978a7.js">
    <link rel="stylesheet" href="/vuejs-training/assets/css/0.styles.bc0ba21a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuejs-training/" class="home-link router-link-active"><!----> <span class="site-name">Introduction to Vue.js</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Language</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Language</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuejs-training/state/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/vuejs-training/fr/" class="nav-link">
  Français
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Language</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Language</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuejs-training/state/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/vuejs-training/fr/" class="nav-link">
  Français
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/vuejs-training/" aria-current="page" class="sidebar-link">Welcome</a></li><li><a href="/vuejs-training/presentation/" class="sidebar-link">Presentation of Vue.js</a></li><li><a href="/vuejs-training/tooling/" class="sidebar-link">Tooling</a></li><li><a href="/vuejs-training/views/" class="sidebar-link">Vue files</a></li><li><a href="/vuejs-training/directives/" class="sidebar-link">Directives</a></li><li><a href="/vuejs-training/components/" class="sidebar-link">Components</a></li><li><a href="/vuejs-training/reactivity/" class="sidebar-link">Reactivity</a></li><li><a href="/vuejs-training/state/" aria-current="page" class="active sidebar-link">State management</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuejs-training/state/#why-a-state-management-solution" class="sidebar-link">Why a state management solution ?</a></li><li class="sidebar-sub-header"><a href="/vuejs-training/state/#data-shared-by-reference" class="sidebar-link">Data shared by reference</a></li><li class="sidebar-sub-header"><a href="/vuejs-training/state/#store-and-controled-mutations" class="sidebar-link">Store and controled mutations</a></li><li class="sidebar-sub-header"><a href="/vuejs-training/state/#pinia" class="sidebar-link">Pinia</a></li><li class="sidebar-sub-header"><a href="/vuejs-training/state/#practical-work-implement-a-pinia-store" class="sidebar-link">Practical work: Implement a Pinia store</a></li></ul></li><li><a href="/vuejs-training/routing/" class="sidebar-link">Routing</a></li><li><a href="/vuejs-training/http/" class="sidebar-link">HTTP Requests</a></li><li><a href="/vuejs-training/tests/" class="sidebar-link">Unit tests</a></li><li><a href="/vuejs-training/reusability/" class="sidebar-link">Reusability and composition</a></li><li><a href="/vuejs-training/ecosystem/" class="sidebar-link">Vue Ecosystem</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="state-management"><a href="#state-management" class="header-anchor">#</a> State management</h1> <p>We saw in the previous section how parent and child components communicate. However, as applications grow and become more complex, components that are far away from each other in the component tree may have to manipulate the same data. It then becomes very tedious to make them share common data references. That's why there are more or less complex <em>state management</em> solutions.</p> <h2 id="why-a-state-management-solution"><a href="#why-a-state-management-solution" class="header-anchor">#</a> Why a state management solution ?</h2> <p><img src="/vuejs-training/assets/img/intro-state-management.72a6047a.png" alt="Problem with shared props on multiple views"></p> <ul><li>because propagating some data ad <code>props</code> of a parent component to the grandchildren and great-grandchildren components quickly becomes tedious</li> <li>to be able to share information between different component trees</li> <li>to delegate data management to a service reachable from all components</li> <li>to be able to persist the data automatically (in <code>localStorage</code> for example)</li> <li>to log application states, or rollback to a previous state with a <em>Cancel</em> feature</li> <li>to help debug, log, monitor or send error reports</li></ul> <h2 id="data-shared-by-reference"><a href="#data-shared-by-reference" class="header-anchor">#</a> Data shared by reference</h2> <p>The simplest solution to the state management problem is to store the data within one or more objects declared in their own module. All components that want to manipulate this data can then import the object and modify its content while working on the same reference.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/** stores/state.js **/</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token literal-property property">loggedIn</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/** LoginForm.vue **/</span>
<span class="token keyword">import</span> state <span class="token keyword">from</span> <span class="token string">&quot;stores/state.js&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span> state <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token string">&quot;John Smith&quot;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>loggedIn <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Note that we have intentionally declared <code>data</code> as an object and not a function, so that instances of the component use the same shared data reference.</p> <p>However, we can also mix local data and shared data:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">sharedState</span><span class="token operator">:</span> state<span class="token punctuation">,</span>
    <span class="token literal-property property">privateState</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <p>This solution can do the job in many cases, but quickly shows its limitations when debugging with many different components interacting with the same data at the same time. Indeed, mutations of state objects are not logged anywhere, so it is difficult to find the origin of a bug.</p> <h2 id="store-and-controled-mutations"><a href="#store-and-controled-mutations" class="header-anchor">#</a> Store and controled mutations</h2> <p>A slightly more advanced pattern is to declare a <em>store</em> object that encapsulates the state object and serves as a control interface. The state object is not directly reachable from the outside by reference, but the store provides methods to interact with: typically a getter / setter. We can then add in these methods other features for debugging, monitoring, performance measurement etc.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/** stores/store.js **/</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;hello&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// no export for state</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">DEBUG_MODE</span><span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;[store] get&quot;</span><span class="token punctuation">,</span> prop<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> state<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">set</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">DEBUG_MODE</span><span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;[store] set&quot;</span><span class="token punctuation">,</span> prop<span class="token punctuation">)</span><span class="token punctuation">;</span>
    state<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code><span class="token comment">&lt;!-- MyComponent.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&quot;@/stores/store.js&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">privateState</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      store
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;bye!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="pinia"><a href="#pinia" class="header-anchor">#</a> Pinia</h2> <p>Once you have a store pattern, it is tempting to enrich it with many features and take advantage of the centralization of state mutations. This has been a field of research for many development teams, especially outside Vue ecosystem, for example the work on the <em>Flux</em> architecture done by the React team.</p> <p>The Vue community went through the same process and came to <a href="https://vuex.vuejs.org/" target="_blank" rel="noopener noreferrer">Vuex<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, a proposal for an official state management solution for Vue. After Vue 3 release and the introduction of the <a href="/reusability">Composition API</a>, a new library called <a href="https://pinia.vuejs.org/" target="_blank" rel="noopener noreferrer">Pinia<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> replaced VueX as the official recommendation. That's what we are going to use here.</p> <p>Pinia is the culmination of this centralized store pattern. It is the official state management solution provided by the Vue team. Pinia will not necessarily find its place in all Vue projects, but it is a very efficient tool in large applications that handle a lot of data.</p> <p>Pinia works with the following concepts:</p> <ul><li>the <strong>state</strong>, which holds the <em>data</em> of your store</li> <li>the <strong>actions</strong>, which are used to mutate the store, equivalent to <em>methods</em> in components</li> <li>the <strong>getters</strong>, which are helpers to access to your store data, equivalent to <em>computed</em></li></ul> <p>The mutated state updates reactively all the views that use it, regardless of their depth in the component tree.</p> <h2 id="practical-work-implement-a-pinia-store"><a href="#practical-work-implement-a-pinia-store" class="header-anchor">#</a> Practical work: Implement a Pinia store</h2> <ol><li>Install <code>pinia</code> and <code>pinia-plugin-persistedstate</code> dependencies that will be used to persist store state.</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> pinia pinia-plugin-persistedstate
</code></pre></div><ol start="2"><li>Create a Pinia store for the session by creating a <code>src/stores/session.js</code> file with following content:</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> useSession <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">'session'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">persist</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">loggedIn</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">actions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">login</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> user <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>loggedIn <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>user <span class="token operator">=</span> user
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="3"><li>Declare the store in your application by completing the <code>main.js</code> file like this:</li></ol> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createPinia <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>
<span class="token keyword">import</span> piniaPluginPersistedstate <span class="token keyword">from</span> <span class="token string">'pinia-plugin-persistedstate'</span>

<span class="token keyword">const</span> pinia <span class="token operator">=</span> <span class="token function">createPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>piniaPluginPersistedstate<span class="token punctuation">)</span>

<span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>pinia<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
</code></pre></div><ol start="4"><li>In the application code, retrieve the <code>loggedIn</code> variable from the store with <code>useSession()</code></li></ol> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The <code>mapState</code> and <code>mapActions</code> are helpers provided with Pinia that can be used to shorten the code by easily linking store data and actions to computed and methods.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useSession <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/stores/session&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> mapState<span class="token punctuation">,</span> mapActions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// bind this.loggedIn to useSession().loggedIn</span>
    <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span>useSession<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;loggedIn&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// bind this.login to useSession().login  </span>
    <span class="token operator">...</span><span class="token function">mapActions</span><span class="token punctuation">(</span>useSession<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <ol start="5"><li>In <code>LoginForm.vue</code>, on form submit, check if the user has entered the email address <code>test@test.com</code> and the password <code>test1234</code>. If so, trigger the <code>login</code> action for the user <code>test</code>.</li></ol> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Invoking an action from a component is done by calling it as a method of the store:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> session <span class="token operator">=</span> <span class="token function">useSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
session<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">firstname</span><span class="token operator">:</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">lastname</span><span class="token operator">:</span> <span class="token string">&quot;Smith&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <ol start="6"><li>Login with the identifiers mentioned above, check that the navigation to the search form is working properly, then refresh the page.</li></ol> <p><strong>Question</strong>: Why don't we return to the login form after refreshing the page ?</p> <ol start="7"><li><p>If the user has entered wrong credentials in the login form, display an error message below the login button. To help you, you can declare an additional <code>error</code> string in the component's <code>data</code>.</p></li> <li><p><strong>Bonus</strong>: Code a <code>logout</code> action and add a logout button in <code>App</code> component that invokes this action. Display the name of the logged in user next to this button.</p></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vuejs-training/reactivity/" class="prev">
        Reactivity
      </a></span> <span class="next"><a href="/vuejs-training/routing/">
        Routing
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vuejs-training/assets/js/app.1ac87feb.js" defer></script><script src="/vuejs-training/assets/js/3.9c71ca5a.js" defer></script><script src="/vuejs-training/assets/js/23.3703f9a3.js" defer></script>
  </body>
</html>
